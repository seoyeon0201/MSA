## 1. API Gatewayë€?

1. API Gateway Service

1) ì—­í• 

- ì‚¬ìš©ìê°€ ì„¤ì •í•œ ë¼ìš°íŒ… ì„¤ì •ì— ë”°ë¼ ê° ì—”ë“œí¬ì¸íŠ¸ë¡œ í´ë¼ì´ì–¸íŠ¸ ëŒ€ì‹ í•´ ìš”ì²­í•˜ê³ , ì‘ë‹µ ë°›ìœ¼ë©´ ë‹¤ì‹œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬í•´ì£¼ëŠ” í”„ë¡ì‹œ ì—­í• 
- ì‹œìŠ¤í…œì˜ ë‚´ë¶€ êµ¬ì¡°ëŠ” ìˆ¨ê¸°ê³  ì™¸ë¶€ ìš”ì²­ì— ëŒ€í•´ ì ì ˆí•œ í˜•íƒœë¡œ ê°€ê³µí•´ì„œ ì‘ë‹µí•´ì¤„ìˆ˜ ìˆìŒ

- ê°ê°ì˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¡œ ìš”ì²­ë˜ëŠ” ëª¨ë“  ì •ë³´ë¥¼ ì¼ê´„ì ìœ¼ë¡œ ì²˜ë¦¬

2. ë™ì‘
   í”„ë¡ íŠ¸ì—”ë“œ(client mobile app, client SPA Web app, ì „í†µì ì¸ web app ë“±)ëŠ” ì§ì ‘ì ìœ¼ë¡œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šê³ , API gatewayë§Œ ìƒëŒ€

3. ì¥ì 

- ì¸ì¦ ë° ê¶Œí•œ ë¶€ì—¬
- ì„œë¹„ìŠ¤ ê²€ìƒ‰ í†µí•©
- ì‘ë‹µ ìºì‹±
- ì •ì±…, íšŒë¡œ ì°¨ë‹¨ê¸° ë° QoS ë‹¤ì‹œ ì‹œë„
- ì†ë„ ì œí•œ
- ë¶€í•˜ ë¶„ì‚°
- ë¡œê¹…, ì¶”ì , ìƒê´€ê´€ê³„
- í—¤ë”, ì¿¼ë¦¬ ë¬¸ìì—´ ë° ì²­êµ¬ ë³€í™˜
- IP í—ˆìš© ëª©ë¡ì— ì¶”ê°€

2. Neflix Ribbon

1) Spring Cloudì—ì„œì˜ MSA ê°„ í†µì‹ 
   : ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì‚¬ì´ì˜ í†µì‹ 

- RestTemplate
  : í•˜ë‚˜ì˜ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë‹¤ë¥¸ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” API

```
//ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
RestTemplate restTemplate = new RestTemplate();
//ì ‘ì†í•˜ê³ ìí•˜ëŠ” ì„œë²„ì˜ ì£¼ì†Œì™€ í¬íŠ¸ë²ˆí˜¸, íŒŒë¼ë¯¸í„°ê¹Œì§€ ì „ë‹¬
restTemplate.getForObject("http://localhost:8080/", User.class, 200);
```

- Feign Client
  : íŠ¹ì • ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì„±í•´ ì¶”ê°€ì ìœ¼ë¡œ ë“±ë¡í•˜ê³  ì‹¶ì€ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì´ë¦„ì„ @FeignClientì— ë“±ë¡ => í•˜ë‚˜ì˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ ìì‹ ì´ ê°€ì§„ APIì¸ ê²ƒì²˜ëŸ¼ ììœ ë¡­ê²Œ ì‚¬ìš© ê°€ëŠ¥

```
@FeignClient("stores")
public interface StoreClient {
    @RequestMapping(method=RequestMethod.Get, value="/stores")
    List<Store> getStores();
}
```

2. Ribbon (Client side Load Balancer)
   : API Gatewayë¥¼ ë³„ë„ë¡œ êµ¬ì¶•í•˜ì§€ ì•Šê³  client ë‚´ë¶€ì— Ribbonì´ë¼ëŠ” ì„œë¹„ìŠ¤ë¥¼ êµ¬ì¶•í•˜ì—¬ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ì§ì ‘ì ì¸ ì„œë¹„ìŠ¤ì™€ í†µì‹ í•˜ì§€ ì•Šê³  ê°„ì ‘ì ìœ¼ë¡œ í†µì‹  ê°€ëŠ¥

- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì´ë¦„ìœ¼ë¡œ í˜¸ì¶œ ê°€ëŠ¥í•œ ë¡œë“œë°¸ëŸ°ì„œ
- health check ê°€ëŠ¥
  ã„´ í• ë‹¹í•˜ëŠ” ì„œë¹„ìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘ ì¤‘ì¸ì§€ í™•ì¸

ğŸš« Spring Cloud Ribbonì€ Spring Boot 2.4ì—ì„œ Maintenance ìƒíƒœ(ì‚¬ìš©í•  ìˆ˜ ìˆì„ì§€ ì—†ì„ì§€ ëª¨ë¦„)

3. Netflix Zuul
   : API Gateway ì—­í• 

1) ê¸°ëŠ¥

- Routing
- API gateway

ğŸš« Spring Cloud Zuulì€ Spring Boot 2.4ì—ì„œ Maintenance ìƒíƒœ(ì‚¬ìš©í•  ìˆ˜ ìˆì„ì§€ ì—†ì„ì§€ ëª¨ë¦„)

âš¡ï¸ Ribbonì€ Spring Cloud Loadbalancer, Zuulì€ Spring Cloud Gatewayë¡œ ëŒ€ì²´í•´ ì‚¬ìš©

## 2. Netflix Zuul ì‹¤ìŠµ

- eureka ì‚¬ìš©í•˜ì§€ ì•Šì§€ë§Œ ì¼ë‹¨ ë„£ê¸° => í›„ì— ì‚¬ìš©

1. í™˜ê²½ì„¤ì •

- Spring Boot: 2.3.8
- Dependencies: Lombok, Spring Web, Eureka Discovery Client

2. Service ìƒì„±

1) First Service

- FirstServiceController (FirstServiceApplicationê³¼ ë™ì¼ ìœ„ì¹˜)

```
@RestController
@RequestMapping("/)
public class FirstServiceController {
    @GetMapping("/welcome")
    public String welcome() {
        return "Welcome to the First Service";
    }
}
```

- application.yml

```
server:
    port: 8081

spring:
    application:
        name: my-first-service

eureka:
    client:
        register-with-eureka: false
        fetchRegistry: false
```

2. Second Service

- SecondServiceController (SecondServiceApplicationê³¼ ë™ì¼ ìœ„ì¹˜)

```
@RestController
@RequestMapping("/)
public class SecondServiceController {
    @GetMapping("/welcome")
    public String welcome() {
        return "Welcome to the Second Service";
    }
}
```

- application.yml

```
server:
    port: 8082

spring:
    application:
        name: my-second-service

eureka:
    client:
        register-with-eureka: false
        fetchRegistry: false
```

3. Test
   ë¸Œë¼ìš°ì €ì— `IP:8081/welcome` ê³¼ `IP:8082/welcome` ì…ë ¥

4. í™˜ê²½ì„¤ì •

- Spring Boot: 2.3.8
- Dependencies: Lombok, Spring Web, Zuul

5. Service ìƒì„±

1) Application ì‹¤í–‰ í´ë˜ìŠ¤ì— `@EnableZuulProxy` ì¶”ê°€

2) application.yml

```
server:
    port: 8000

spring:
    application:
        name: my-zuul-service

//ê°€ì¥ ì¤‘ìš”
zuul:
    routes:
        first-service:
            path: /first-service/**
            url: http://localhost:8081
        second-service:
            path: /second-service/**
            url: http://localhost:8082
```

6. Test
   ë¸Œë¼ìš°ì €ì— `IPì£¼ì†Œ:8000/first-service/welcome` ê³¼ `IPì£¼ì†Œ:8000/second-service/welcome` ì…ë ¥
   => ì²˜ìŒ ì£¼ì†Œì—ì„œëŠ” first Serviceê°€, ë‘ë²ˆì§¸ì—ì„œëŠ” secondServiceê°€ ì‹¤í–‰ë¨

7. ZuulFilter
   : ì‚¬ì „ì²˜ë¦¬, ì‚¬í›„ì²˜ë¦¬ ê°€ëŠ¥ ex. ì¸ì¦, ë¡œê¹…

- com.example.zuulservice > filter > ZuulLoggingFilter
- ë§ˆìš°ìŠ¤ ìš°í´ë¦­ > Generate(ctrl+n) > implement Methods : í´ë˜ìŠ¤ ì•ˆì˜ ë©”ì†Œë“œ ìë™ ì™„ì„±

```
@Component
public class ZuulLoggingFilter extends ZuulFilter {

    //run()ì€ ì‚¬ìš©ìê°€ ì‹¤í–‰í• ë•Œë§ˆë‹¤ ì‹¤í–‰
    @Override
    public Object run() throws ZuulException {
        log.info("************ printing logs: ");

        //ì‚¬ìš©ìê°€ ìš”ì²­í•œ URI ë³´ì—¬ì¤Œ
        RequestContext ctx = RequestContext.getCurrentContext();
        HttpServletRequest request = ctx.getRequest();
        log.info("************ "+ request.getRequestURI());
        return null;
    }

    @Override
    public String filterType() {
        return "pre";
    }

    @Override
    public int filterOrder() {
        return 1;
    }

    @Override
    public boolean shouldFilter() {
        return true;
    }

}
```

## 3. Spring Cloud Gatewayë€?

- Spring Cloud Gatewayë¥¼ ì‚¬ìš©í•˜ëŠ” ì£¼ëœ ëª©ì ì€ ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸. Zuulì€ ë™ê¸° ë°©ì‹
  => ë”°ë¼ì„œ Zuul ì‹¤í–‰ ì‹œì—ëŠ” tomcat ì‹¤í–‰ë˜ì—ˆì§€ë§Œ, Spring Cloud Gateway ì‚¬ìš©ì‹œ Netty ì‹¤í–‰

1. í™˜ê²½ì„¤ì •

- Spring Boot: 2.4.2
- Dependencies: DevTools, Eureka Discovery Client, `Gateway`

2. Service ìƒì„±

1) ìœ„ì—ì„œ ìƒì„±í•œ FirstServiceì™€ SecondService ì˜ RequestMappingë§Œ ë³€ê²½
   ã„´ application.ymlì—ì„œì˜ ì½”ë“œëŠ” ì¡°ê±´ì´ ë§ì„ ê²½ìš° `http://localhost:8081/first-service/welcome`ì™€ ê°™ì´ ë™ì‘í•˜ê¸° ë•Œë¬¸. RequestMappingì„ ìˆ˜ì •í•˜ì§€ ì•Šì„ ê²½ìš°ëŠ” `http://localhost:8081/welcome`

```
@RestController
@RequestMapping("/first-service")
public class FirstServiceController {
    ...
}
```

```
@RestController
@RequestMapping("/second-service")
public class SecondServiceController {
    ...
}
```

2. application.yml

```
server:
    port: 8000

eureka:
    client:
        register-with-eureka: false
        fetch-registry: false
        service-url:
            defaultZone: http://localhost:8761/eureka

spring:
    application:
        name: gateway-service
    cloud:
        gateway:
            routes:
                - id: first-service
                  uri: http://localhost:8081/
                  predicates:                     //ì¡°ê±´: path ì •ë³´ê°€ first-serviceë¡œ ì‹œì‘í•˜ëŠ” ê²½ìš°
                      - Path=/first-service/**
                - id: second-service
                  uri: http://localhost:8082/
                  predicates:
                      - Path=/second-service/**
```

3. Test
   ë¸Œë¼ìš°ì €ì— `IPì£¼ì†Œ:8000/first-service/welcome` ì‘ì„±ì‹œ FirstServiceë¡œ ì´ë™

## 4. Spring Cloud Gateway - Filter ì ìš© (java code)

- í˜„ì¬ application.ymlì— routing ì •ë³´ë§Œ ì¡´ì¬
- ìë°” ì½”ë“œì—ì„œë„ routing ì •ë³´ì™€ filterê¹Œì§€ í™œìš© ê°€ëŠ¥

1. Spring Cloud gatewayì˜ êµ¬ì¡°

- Pre Filter ì´í›„ Post Filter ì´ì „ì—ëŠ” Servlet(Controller ë™ì‘)ì´ ì¡´ì¬

![Alt text](image.png)

2. ì½”ë“œ ìˆ˜ì •

1) application.ymlì—ì„œ ì‹¤í–‰í•˜ë˜ ì½”ë“œ(ì•„ë˜)ë¥¼ Java ì½”ë“œë¡œ ì‹¤í–‰ ê°€ëŠ¥ => ymlì—ì„œ ì£¼ì„ì²˜ë¦¬ í›„ ì‹¤í–‰

```
spring:
    cloud:
        ...
```

2. Java Code ì‚¬ìš©í•œ filter : com.example.apigatewayservice > config > FilterConfig.java

- ìœ„ ì½”ë“œì—ì„œ Gateway Handler Mapping ì‹œ request í—¤ë”ë¥¼ ì¶”ê°€í•˜ê³ , response ë³´ë‚¼ ë•Œ response í—¤ë”ê°’ì„ ë„£ì–´ ë°˜í™˜

```
@Configuration  //í•´ë‹¹ annotationì„ ëª¨ë‘ ëª¨ì•„ ë©”ëª¨ë¦¬ì— ë“±ë¡
public class FilterConfig {
    @Bean
    public RouteLocator gatewayRoutes(RouteLocatorBuilder builder) {
        return builder.routes()
            //`/first-service`ë¡œ ì‹œì‘í•˜ëŠ” ê²½ìš° ì•„ë˜ì˜ ë‘ ì‘ì—… ì¶”ê°€. path í™•ì¸ í›„ urië¡œ ì´ë™. filtersë¥¼ í†µí•´ requestHeaderì™€ responseHeader ì¶”ê°€(key("first-request")-value("first-request-header") í˜•íƒœ)
            .route(r -> r.path("/first-service/**")
                .filters(f-> f.addRequestHeader("first-request", "first-request-header")
                    .addResponseHeader("first-response", "first-response-header"))
                .uri("http://localhost:8081/"))

            //`/second-service`ë¡œ ì‹œì‘í•˜ëŠ” ê²½ìš° ì•„ë˜ì˜ ë‘ ì‘ì—… ì¶”ê°€
            .route(r -> r.path("/second-service/**")
                .filters(f-> f.addRequestHeader("second-request", "second-request-header")
                    .addResponseHeader("second-response", "second-response-header"))
                .uri("http://localhost:8082/"))
            .build();
    }
}
```

3. FirstServiceController.javaì™€ SecondServiceController.java ìˆ˜ì •
   : servlet(controller)ì—ì„œ í—¤ë”ê°€ ì¶œë ¥ì´ ë˜ë„ë¡

(1) FirstServiceController.java

```
@RestController
@RequestMapping("/first-service")
public class FirstServiceController {
    @GetMapping("/welcome")
    public String welcome() {
        return "Welcome to the First Service";
    }

    @GetMapping("/message")
    public String message(@RequestHeader("first-request") String header) {
        System.out.println(header);
        return "Hello World in First Service";
    }
}
```

(2) SecondServiceController.java

```
@RestController
@RequestMapping("/second-service")
public class SecondServiceController {
    @GetMapping("/welcome")
    public String welcome() {
        return "Welcome to the Second Service";
    }

    @GetMapping("/message")
    public String message(@RequestHeader("second-request") String header) {
        System.out.println(header);
        return "Hello World in Second Service";
    }
}
```

2. Test
   ë¸Œë¼ìš°ì €ì— `IP:8000/first-service/message` ì…ë ¥ ì‹œ í—¤ë”ê°’ì´ ë‚˜íƒ€ë‚˜ëŠ”ì§€ í™•ì¸

=> ì²˜ìŒì— headerê°€ ì—†ì—ˆëŠ”ë° Spring Cloud Gatewayì—ì„œ ì¶”ê°€ëœ headerë¥¼ í™•ì¸í•´ë³´ëŠ” ê²ƒ
=> response headerëŠ” ë¸Œë¼ìš°ì €ì˜ ê°œë°œì ë„êµ¬ > Network ì—ì„œ í™•ì¸ ê°€ëŠ¥

## 4. Spring Cloud Gateway - Filter ì ìš© (application.yml)

- application.ymlì—ì„œë„ ë¼ìš°íŒ…ê³¼ filter ê¸°ëŠ¥ ê°€ëŠ¥

- FilterConfig.javaì˜ @Configurationê³¼ @Beanë§Œ ì£¼ì„ ì²˜ë¦¬ í›„ ì§„í–‰ => filter ê¸°ëŠ¥ X
- application.ymlì—ì„œ ì£¼ì„ì²˜ë¦¬í•œ ë¶€ë¶„ ì£¼ì„ ì·¨ì†Œ

1. application.yml

```
spring:
    application:
        name: gateway-service
    cloud:
        gateway:
            routes:
                - id: first-service
                  uri: http://localhost:8081/
                  predicates:                     //ì¡°ê±´: path ì •ë³´ê°€ first-serviceë¡œ ì‹œì‘í•˜ëŠ” ê²½ìš°
                      - Path=/first-service/**
                  filters:
                    - AddRequestHeader=first-request, first-request-header2  //first-request ì´ë¦„ì˜ header ê°’ì´ first-request-header2
                    - AddResponseHeader=first-response, first-response-header2
                - id: second-service
                  uri: http://localhost:8082/
                  predicates:
                    - Path=/second-service/**
                  filters:
                    - AddRequestHeader=second-request, second-request-header2
                    - AddResponseHeader=second-response, second-response-header2
```

## 4. Spring Cloud Gateway - Custom Filter ì ìš©

- ì›í•˜ëŠ” route ì •ë³´ì— ê°œë³„ì ìœ¼ë¡œ ë“±ë¡í•´ì•¼í•¨ (cf. globalFilterëŠ” ê³µí†µì ìœ¼ë¡œ ë“±ë¡ ê°€ëŠ¥)

com.example.apigatewayservice > filter > CustomFilter
generate > implement methodì—ì„œ apply ë©”ì†Œë“œ í˜¸ì¶œ

1. ì½”ë“œ ìˆ˜ì •

1) CustomFilter.java

```
//extends í•´ì•¼í•¨
@Component
public class CustomFilter extends AbstractGatewayFilterFactory<CustomFilter.Config> {
    public CustomFilter() {
        super(Config.class);
    }

    public static class Config {
        //Put the configuration properties
    }


    //êµ¬í˜„ì‹œ apply
    @Override
    public GatewayFilter apply(Config config) {
        //Custom Pre Filter
        return (exchange, chain) -> {       //exchangeëŠ” request, chainì€ response
            ServerHttpRequest request = exchange.getRequest();
            ServerHttpRequest response = exchange.getResponse();

            log.info("Custom PRE filter: request id -> {}", request.getId());

            //Custom Post Filter
            return chain.filter(exchange).then(Mono.fromRunnable(() -> {
                log.info("Custom POST filter: response code -> {}", response.getStatusCode());
            }));
        };
    }
}
```

2. application.yml

```
spring:
    application:
        name: gateway-service
    cloud:
        gateway:
            routes:
                - id: first-service
                  uri: http://localhost:8081/
                  predicates:                     //ì¡°ê±´: path ì •ë³´ê°€ first-serviceë¡œ ì‹œì‘í•˜ëŠ” ê²½ìš°
                      - Path=/first-service/**
                  filters:
                    <!-- - AddRequestHeader=first-request, first-request-header2  //first-request ì´ë¦„ì˜ header ê°’ì´ first-request-header2
                    - AddResponseHeader=first-response, first-response-header2 -->
                    - CustomFilter
                - id: second-service
                  uri: http://localhost:8082/
                  predicates:
                    - Path=/second-service/**
                  filters:
                    <!-- - AddRequestHeader=second-request, second-request-header2
                    - AddResponseHeader=second-response, second-response-header2 -->
                    - CustomFilter
```

3. FirstServiceController.javaì™€ SecondServiceController.javaì— ê°ê° ì•„ë˜ ì½”ë“œ ì¶”ê°€

```
@GetMapping("/check")
public String check() {
    return "Hi, there. This is a message from First Service";
}
```

```
@GetMapping("/check")
public String check() {
    return "Hi, there. This is a message from Second Service";
}
```

2. Test
   `http://localhost:8000/first-service/check`ì™€ `http://localhost:8000/second-service/check`

## 5. Spring Cloud Gateway - Global Filter ì ìš©

GlobalFilter.java

```
//extends í•´ì•¼í•¨
@Component
public class GlobalFilter extends AbstractGatewayFilterFactory<GlobalFilter.Config> {
    public GlobalFilter() {
        super(Config.class);
    }


    //êµ¬í˜„ì‹œ apply
    @Override
    public GatewayFilter apply(Config config) {
        //Global Pre Filter
        return (exchange, chain) -> {       //exchangeëŠ” request, chainì€ response
            ServerHttpRequest request = exchange.getRequest();
            ServerHttpRequest response = exchange.getResponse();

            log.info("Global Filter baseMessge: {}", config.getBaseMessage());
            if (config.isPreLogger()) {
                log.info("Global Filter Start: request id -> {}", request.getId());
            }

            //Gloabl Post Filter
            return chain.filter(exchange).then(Mono.fromRunnable(() -> {
                if (config.isPostLogger()) {
                    log.info("Global Filter End: response code -> {}", response.getStatusCode());
                }
            }));
        };
    }

    @Data
    public static class Config {
        private String baseMessage;
        private boolean preLogger;
        private boolean postLogger;
    }
}
```

application.yml

```
spring:
    application:
        name: gateway-service
    cloud:
        gateway:
            default-filters:
                - name: GlobalFilter
                  args:
                    baseMessage: Spring Cloud Gateway Global Filter
                    preLogger: true
                    postLogger: true
            routes:
                - id: first-service
                  uri: http://localhost:8081/
                  predicates:                     //ì¡°ê±´: path ì •ë³´ê°€ first-serviceë¡œ ì‹œì‘í•˜ëŠ” ê²½ìš°
                      - Path=/first-service/**
                  filters:
                    <!-- - AddRequestHeader=first-request, first-request-header2  //first-request ì´ë¦„ì˜ header ê°’ì´ first-request-header2
                    - AddResponseHeader=first-response, first-response-header2 -->
                    - CustomFilter
                - id: second-service
                  uri: http://localhost:8082/
                  predicates:
                    - Path=/second-service/**
                  filters:
                    <!-- - AddRequestHeader=second-request, second-request-header2
                    - AddResponseHeader=second-response, second-response-header2 -->
                    - CustomFilter
```

## 6. Spring Cloud Gateway - Load Balancer

** Spring Cloud Gatewayì™€ Eureka ì—°ë™**

- clientì—ì„œ API Gatewayë¡œ ìš”ì²­ -> Eureka Serverì—ì„œ í•´ë‹¹ ì„œë¹„ìŠ¤ ìœ„ì¹˜ ê²€ìƒ‰ -> ì–»ì€ ìœ„ì¹˜ë¡œ forward

- Eureka ì—­í• : Service Discovery + Registration

1. í™˜ê²½ ì„¤ì •

1) pom.xml : Spring Cloud Gateway, First Service, Second Service

```
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
</dependency>
```

2. application.yml : Spring Cloud Gateway, First Service, Second Service

```
eureka:
    client:
    register-with-eureka: true
    fetch-registry: true
    service-url:
        defaultZone: http://localhost:8761/eureka
```

3. application.yml : Spring Cloud Gateway

```
...
    cloud:
        gateway:
            default-filters: <1 item>
            routes:
                - id: first-service
                  uri: lb://MY-FIRST-SERVICE    //discoverì— ë“±ë¡ë˜ì–´ìˆëŠ” ì´ë¦„ìœ¼ë¡œ ì„¤ì •
                  predicates:
                    - Path=/first-service/**
                  filters: <1 item>
                - id: second-service
                  uri: lb://MY-SECOND-SERVICE
                  predicates:
                    - Path=/second-service/**
                  filters: <2 items>
```

4. Service ë“±ë¡ í™•ì¸

- Spring Cloud Gateway, First Service, Second Service ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ ë° Eureka í™•ì¸

ë¸Œë¼ìš°ì €ì— `IPì£¼ì†Œ"8761`ìœ¼ë¡œ Eureka í™•ì¸

2. Spring Cloud Gateway ì •ë¦¬

- apigateway-serviceì˜ application.ymlì˜ routes/urië¥¼ lb://MY-FIRST-SERVICE ì™€ ê°™ì´ eurekaì— ì§€ì •ëœ ì´ë¦„ìœ¼ë¡œ ì„¤ì •
- firstServiceì˜ application.ymlì˜ server: port: 0ìœ¼ë¡œ ì„¤ì •í•´ ëœë¤ ì„¤ì • => RoundRobinìœ¼ë¡œ ë²ˆê°ˆì•„ê°€ë©´ì„œ ì„ íƒë¨
